@page "/login"
@layout BaseLayout

<EditForm Model="@_user">
    <div class="wrapper fadeInDown">
        <div id="formContent">
            <!-- Tabs Titles -->
            <h2 class="active"> Login </h2>
            <h2 class="inactive underlineHover">Cadastro</h2>

            <!-- Icon -->
            <div class="fadeIn first">
                <img src="https://cdn-icons-png.flaticon.com/128/5968/5968204.png" id="icon" alt="User Icon" />
            </div>

            <!-- Login Form -->
            <form>
                <input type="text" id="login" class="fadeIn second" name="login" placeholder="Email" @bind = "@email">
                <input type="text" id="password" class="fadeIn third" name="login" placeholder="Senha" @bind = "@senha" />
                <input type="submit" class="fadeIn fourth" value="Login" @onclick="HandleSubmit">
            </form>

            <!-- Remind Passowrd -->
            <div id="formFooter">
                <a class="underlineHover" href="#">Esqueceu a senha ?</a>
            </div>

        </div>
    </div>
</EditForm>

@code {
    public User _user = new();
    string email;
    string senha;


    private async Task HandleSubmit()
    {
        _user.Email = email;
        _user.Password = senha;

        try
        {
            using (HttpClient client = new HttpClient())
            {
                string url = "https://localhost:7207/login";

                string jsonContent = JsonConvert.SerializeObject(_user, Formatting.Indented);

                var content = new StringContent(jsonContent, System.Text.Encoding.UTF8, "application/json");

                HttpResponseMessage response = await client.PostAsync(url, content);

                if (response.IsSuccessStatusCode)
                {
                    string responseContent = await response.Content.ReadAsStringAsync();

                    Console.WriteLine("sucess" + content);
                }
                else
                {
                    Console.Write(response);
                }
            }

            
        }
        catch (Exception)
        {
            
            throw;
        }
    }
}
